<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Timesheet Modern</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f4f6f8;--card:#ffffff;--accent:#2563eb;--muted:#6b7280;}
    *{box-sizing:border-box} body{font-family:Inter,system-ui,Arial,sans-serif;margin:0;background:var(--bg);color:#0f172a}
    .app{display:flex;min-height:100vh}
    .sidebar{width:240px;background:linear-gradient(180deg,#0f172a, #08203a);color:white;padding:20px;display:flex;flex-direction:column;gap:10px}
    .brand{font-weight:700;font-size:1.1rem;margin-bottom:6px}
    .menu{display:flex;flex-direction:column;gap:6px;margin-top:10px}
    .menu button{background:transparent;border:none;color:inherit;text-align:left;padding:10px;border-radius:8px;cursor:pointer;width:100%}
    .menu button.active{background:rgba(255,255,255,0.06)}
    .main{flex:1;padding:24px}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(12,17,23,0.06)}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:18px}
    .list{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    .item{padding:10px;border-radius:8px;border:1px solid #eef2f7;background:transparent;display:flex;justify-content:space-between;align-items:center}
    label{display:block;font-size:0.9rem;color:var(--muted);margin-bottom:6px}
    input,select,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #e6eef7;background:white}
    button.btn{background:var(--accent);color:white;padding:10px 12px;border-radius:8px;border:none;cursor:pointer}
    .muted{color:var(--muted);font-size:0.9rem}
    .report-canvas{width:100%;height:220px;background:white;border-radius:8px;padding:10px}
    .login-row{display:flex;gap:8px;align-items:center}
    .top-controls{display:flex;gap:8px;align-items:center}
    @media(max-width:900px){ .app{flex-direction:column} .sidebar{width:100%;flex-direction:row;overflow:auto}.grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">Timesheet Modern</div>
      <div class="muted">Registro de horas</div>
      <div class="menu" id="menu">
        <button data-view="times" class="active">Horas</button>
        <button data-view="new">Nuevo</button>
        <button data-view="reports">Reportes</button>
        <button data-view="users">Usuarios</button>
      </div>
      <div style="margin-top:auto">
        <div class="muted" id="userInfo">No conectado</div>
      </div>
    </aside>
    <main class="main">
      <div class="header">
        <h2 id="pageTitle">Horas</h2>
        <div class="top-controls">
          <div id="authControls"></div>
        </div>
      </div>

      <div id="contentArea"></div>
    </main>
  </div>

  <template id="timesTpl">
    <div class="card">
      <div class="grid">
        <div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>Tus registros</strong>
              <div class="muted">Lista de horas guardadas (local + servidor)</div>
            </div>
            <div class="muted" id="timesCount"></div>
          </div>

          <div class="list" id="timesList"></div>
        </div>
        <div>
          <div style="margin-bottom:10px"><strong>Añadir rápido</strong><div class="muted">Completa y guarda rápido</div></div>
          <div>
            <label>Usuario</label>
            <select id="fastUser"></select>
            <label>Proyecto</label>
            <select id="fastProject"></select>
            <label>Fecha</label>
            <input type="date" id="fastDate" />
            <label>Horas</label>
            <input type="number" step="0.25" id="fastHours" />
            <label>Descripción</label>
            <textarea id="fastDesc" rows="3"></textarea>
            <div style="margin-top:8px;display:flex;gap:8px">
              <button class="btn" id="saveFast">Guardar</button>
              <button class="btn" id="clearFast" style="background:#e2e8f0;color:#0f172a">Limpiar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="newTpl">
    <div class="card">
      <strong>Nuevo registro</strong>
      <div class="muted">Crea un registro detallado</div>
      <div style="margin-top:12px">
        <label>Usuario</label><select id="newUser"></select>
        <label>Proyecto</label><select id="newProject"></select>
        <label>Fecha</label><input type="date" id="newDate" />
        <label>Horas</label><input type="number" step="0.25" id="newHours" />
        <label>Descripción</label><textarea id="newDesc" rows="4"></textarea>
        <div style="margin-top:10px">
          <button class="btn" id="saveNew">Guardar</button>
        </div>
      </div>
    </div>
  </template>

  <template id="reportsTpl">
    <div class="card">
      <strong>Reportes</strong>
      <div class="muted">Resumen por proyecto y por usuario</div>
      <div style="margin-top:12px;display:flex;gap:12px;flex-direction:column">
        <div class="card">
          <strong>Por proyecto</strong>
          <canvas id="projChart" class="report-canvas"></canvas>
          <div id="projTable"></div>
        </div>
        <div class="card">
          <strong>Por usuario</strong>
          <canvas id="userChart" class="report-canvas"></canvas>
          <div id="userTable"></div>
        </div>
      </div>
    </div>
  </template>

  <template id="usersTpl">
    <div class="card">
      <strong>Usuarios</strong>
      <div class="muted">Administración simple</div>
      <div style="margin-top:10px">
        <div id="usersList"></div>
      </div>
    </div>
  </template>

  <script src="app.js"></script>
</body>
</html>
